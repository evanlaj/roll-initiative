<div class="handle" [class.disabled]="characters.inCombat" (mousedown)="grab($event)">
  <div class="bar"></div>
  <div class="bar"></div>
  <div class="bar"></div>
  <div class="bar"></div>
</div>
<button [disabled]="characters.isSpectator" type="button" class="team-color" [class.ally]="character.ally" (click)="swapTeam()"></button>
<div class="row">
  <div class="row-left">
    <input [disabled]="characters.isSpectator" type="text" placeholder="Nom du personnage" [(ngModel)]="character.name" class="name-input" />
    <input *ngIf="!characters.inCombat" type="number" placeholder="000" [(ngModel)]="character.maxHP" />
    
    <div class="current-hp" *ngIf="characters.inCombat && !characters.isSpectator">
      <input type="number" placeholder="000" [(ngModel)]="character.currentHP" />
      <div>/{{ character.maxHP }}</div>
    </div>

    <input *ngIf="!characters.isSpectator" [disabled]="characters.inCombat" type="number" placeholder="000" [(ngModel)]="character.armorClass" class="ac-input" />
    <input *ngIf="!characters.inCombat" type="number" placeholder="000" [(ngModel)]="character.bonus" />
    <input *ngIf="!characters.inCombat" type="number" placeholder="000" [(ngModel)]="character.roll" />
    <button *ngIf="!characters.inCombat" type="button" class="row-button" (click)="toggleLock()" [class.open]="!character.lockedRoll">
      <ng-container *ngTemplateOutlet="lockIcon"></ng-container>
    </button>
  </div>
  <div>
    <button 
      type="button" 
      class="row-button del-button" 
      (click)="deleteCharacter()"
      *ngIf="!characters.isSpectator"
    >ðŸž¬</button>
  </div>
</div>


<ng-template #lockIcon>
  <svg 
  *ngIf="character.lockedRoll"
  xmlns="http://www.w3.org/2000/svg" 
  height="48" 
  viewBox="0 -960 960 960" 
  width="48"
  class="lock-icon"
>
  <path 
    d="M218-58q-30.75 0-51.875-21.125T145-131v-438q0-30.75 21.125-51.875T218-642h58v-96q0-85.625 59.662-145.312Q395.323-943 479.972-943q84.648 0 144.338 59.688Q684-823.625 684-738v96h58q30.75 0 51.875 21.125T815-569v438q0 30.75-21.125 51.875T742-58H218Zm262.248-207Q515-265 539.5-289.111T564-347.08q0-32.92-24.748-59.42t-59.5-26.5Q445-433 420.5-406.42q-24.5 26.579-24.5 60Q396-313 420.748-289t59.5 24ZM349-642h262v-96q0-55.167-38.208-93.583Q534.583-870 480-870t-92.792 38.417Q349-793.167 349-738v96Z"
  />
</svg>
<svg
  *ngIf="!character.lockedRoll" 
  xmlns="http://www.w3.org/2000/svg" 
  height="48" 
  viewBox="0 -960 960 960" 
  width="48"
  class="lock-icon"
>
  <path 
    d="M218-642h393v-96q0-55.167-38.208-93.583Q534.583-870 480-870t-92.792 38.417Q349-793.167 349-738h-73q0-86 59.662-145.5 59.661-59.5 144.31-59.5 84.648 0 144.338 59.688Q684-823.625 684-738v96h58q30.75 0 51.875 21.125T815-569v438q0 30.75-21.125 51.875T742-58H218q-30.75 0-51.875-21.125T145-131v-438q0-30.75 21.125-51.875T218-642Zm262.248 377Q515-265 539.5-289.111T564-347.08q0-32.92-24.748-59.42t-59.5-26.5Q445-433 420.5-406.42q-24.5 26.579-24.5 60Q396-313 420.748-289t59.5 24Z"
  />
</svg>
</ng-template>